# RustChat - ç°ä»£åŒ–èŠå¤©è½¯ä»¶

åŸºäºRustçš„ç°ä»£åŒ–èŠå¤©è½¯ä»¶ï¼Œæ”¯æŒå¤šå®¢æˆ·ç«¯å®æ—¶èŠå¤©ã€æœºå™¨äººäº¤äº’ã€æ¶ˆæ¯å†å²ã€æ˜µç§°ç®¡ç†ç­‰åŠŸèƒ½ã€‚

## ğŸ¯ å½“å‰ç‰ˆæœ¬: v0.1.0 (M0 - åŠŸèƒ½åŸå‹)

### âœ… å·²å®ç°åŠŸèƒ½

#### ğŸ” ç”¨æˆ·ç³»ç»Ÿ
- âœ… **USER-001**: UUIDç”¨æˆ·æ ‡è¯†ç”Ÿæˆä¸ç®¡ç†
- âœ… **USER-003**: æ˜µç§°è®¾ç½®ä¸åŒæ­¥ (`/nick <æ˜µç§°>`, `/whoami`)

#### ğŸ“¦ æ•°æ®æŒä¹…åŒ–  
- âœ… **DATA-001**: æœ¬åœ°æ¶ˆæ¯å†å² (SQLiteæ•°æ®åº“)
- âœ… ç”¨æˆ·é…ç½®æœ¬åœ°å­˜å‚¨ (`~/.rustchat/config.json`)
- âœ… æ¶ˆæ¯å†å²æŸ¥è¯¢ (`/history [æ•°é‡]`)

#### ï¿½ ç½‘ç»œé€šä¿¡
- âœ… **NET-002**: å¿ƒè·³ä¿æ´»æœºåˆ¶ (æœåŠ¡å™¨ä¸»åŠ¨Pingï¼Œå®¢æˆ·ç«¯Pong)
- âœ… **NET-003**: æ–­çº¿é‡è¿æœºåˆ¶ (æŒ‡æ•°é€€é¿ï¼Œæœ€å¤§10æ¬¡é‡è¯•)
- âœ… WebSocketå®æ—¶é€šä¿¡

#### ğŸ’¬ å‘½ä»¤ç³»ç»Ÿ
- âœ… **CMD-001**: ç»“æ„åŒ–å‘½ä»¤è§£æå™¨
- âœ… **CMD-002**: å‘½ä»¤åˆ†å‘å™¨ 
- âœ… **CMD-003**: å¸®åŠ©ç³»ç»Ÿ (`/help`)
- âœ… æ”¯æŒå‘½ä»¤: `/nick`, `/whoami`, `/history`, `/clear`, `/quit`

#### ğŸ¤– æœºå™¨äººç³»ç»Ÿ
- âœ… **BOT-001**: Echoæœºå™¨äºº
- âœ… æ”¯æŒ `@echo` æˆ– `@å›å£°` è§¦å‘
- âœ… å†…ç½®å‘½ä»¤: `hello`, `time`, `help`
- âœ… æ’ä»¶åŒ–æ¶æ„ï¼Œæ˜“äºæ‰©å±•

#### ğŸ¨ ç”¨æˆ·ç•Œé¢
- âœ… **UI-001**: CLIé¢œè‰²ä¸»é¢˜
- âœ… æ˜µç§°å½©è‰²æ˜¾ç¤ºï¼ˆåŸºäºç”¨æˆ·åå“ˆå¸Œåˆ†é…é¢œè‰²ï¼‰
- âœ… æ—¶é—´æˆ³ç°è‰²æ˜¾ç¤º
- âœ… æœºå™¨äººæ¶ˆæ¯ç»¿è‰²æ˜¾ç¤º
- âœ… ç³»ç»Ÿæ¶ˆæ¯é»„è‰²æ˜¾ç¤º
- âœ… ç¾è§‚çš„æ¬¢è¿Bannerå’Œåˆ†éš”çº¿

## ğŸš€ å¿«é€Ÿå¼€å§‹

### ç¯å¢ƒè¦æ±‚

- **Rust**: 1.70+ 
- **Cargo**: æœ€æ–°ç‰ˆæœ¬
- **æ“ä½œç³»ç»Ÿ**: Windows, Linux, macOS

### ğŸ“¦ æ„å»ºé¡¹ç›®

```bash
# å…‹éš†é¡¹ç›®
git clone https://github.com/your-username/rustchat.git
cd rustchat

# æ„å»ºæ‰€æœ‰ç»„ä»¶
cargo build --release

# æ„å»ºæŒ‡å®šç»„ä»¶ï¼ˆå¯é€‰ï¼‰
cargo build --bin rustchatd --release    # ä»…æ„å»ºæœåŠ¡å™¨
cargo build --bin rustchat-cli --release # ä»…æ„å»ºå®¢æˆ·ç«¯
```

### ğŸ–¥ï¸ å¯åŠ¨æœåŠ¡å™¨

```bash
# å¯åŠ¨WebSocketæœåŠ¡å™¨
cargo run --bin rustchatd

# æˆ–è€…ä½¿ç”¨å‘å¸ƒç‰ˆæœ¬ï¼ˆæ¨èï¼‰
cargo run --bin rustchatd --release
```

**æœåŠ¡å™¨ä¿¡æ¯:**
- WebSocketåœ°å€: `ws://127.0.0.1:8080/ws`
- å¥åº·æ£€æŸ¥: `http://127.0.0.1:8080/health`
- æ—¥å¿—çº§åˆ«: INFO (å¯é€šè¿‡ `RUST_LOG` ç¯å¢ƒå˜é‡è°ƒæ•´)

### ğŸ“± å¯åŠ¨å®¢æˆ·ç«¯

åœ¨æ–°çš„ç»ˆç«¯çª—å£ä¸­ï¼š

```bash
# å¯åŠ¨CLIå®¢æˆ·ç«¯
cargo run --bin rustchat-cli

# æˆ–è€…ä½¿ç”¨å‘å¸ƒç‰ˆæœ¬ï¼ˆæ¨èï¼‰
cargo run --bin rustchat-cli --release
```

### ğŸ® ä½¿ç”¨æŒ‡å—

#### åŸºæœ¬æ“ä½œ
- **é¦–æ¬¡è¿è¡Œ**: å®¢æˆ·ç«¯è‡ªåŠ¨ç”ŸæˆUUIDå¹¶ä¿å­˜åˆ° `~/.rustchat/`
- **å‘é€æ¶ˆæ¯**: ç›´æ¥è¾“å…¥æ–‡æœ¬å†…å®¹
- **è®¾ç½®æ˜µç§°**: `/nick <ä½ çš„æ˜µç§°>`
- **æŸ¥çœ‹å¸®åŠ©**: `/help`
- **é€€å‡ºç¨‹åº**: `/quit` æˆ– `/exit`

#### å®ç”¨å‘½ä»¤
```bash
/nick Alice           # è®¾ç½®æ˜µç§°ä¸º Alice
/whoami              # æŸ¥çœ‹å½“å‰ç”¨æˆ·ä¿¡æ¯
/history 20          # æ˜¾ç¤ºæœ€è¿‘20æ¡æ¶ˆæ¯å†å²
/clear               # æ¸…ç©ºå±å¹•
/help                # æ˜¾ç¤ºè¯¦ç»†å¸®åŠ©ä¿¡æ¯
```

#### æœºå™¨äººäº¤äº’
```bash
@echo hello          # å‘Echoæœºå™¨äººå‘é€hello
@å›å£° time           # è·å–å½“å‰æ—¶é—´
@echo help           # æŸ¥çœ‹æœºå™¨äººå¸®åŠ©
```

### ğŸ§ª å¤šå®¢æˆ·ç«¯æµ‹è¯•

#### æ–¹æ³•ä¸€ï¼šåŒç»ˆç«¯æµ‹è¯•
1. **å¯åŠ¨æœåŠ¡å™¨**ï¼š
   ```bash
   cargo run --bin rustchatd
   ```

2. **å¯åŠ¨ç¬¬ä¸€ä¸ªå®¢æˆ·ç«¯** (ç»ˆç«¯A)ï¼š
   ```bash
   cargo run --bin rustchat-cli
   ```

3. **å¯åŠ¨ç¬¬äºŒä¸ªå®¢æˆ·ç«¯** (ç»ˆç«¯B)ï¼š
   ```bash
   cargo run --bin rustchat-cli
   ```

4. **å¼€å§‹èŠå¤©**ï¼š
   - åœ¨ç»ˆç«¯Aè®¾ç½®æ˜µç§°: `/nick Alice`
   - åœ¨ç»ˆç«¯Bè®¾ç½®æ˜µç§°: `/nick Bob`
   - ç›¸äº’å‘é€æ¶ˆæ¯æµ‹è¯•å®æ—¶é€šä¿¡

#### æ–¹æ³•äºŒï¼šä¸€é”®å¯åŠ¨è„šæœ¬

**Windows (PowerShell)**:
```powershell
# å¯åŠ¨æœåŠ¡å™¨
Start-Process powershell -ArgumentList "-NoExit", "-Command", "cargo run --bin rustchatd"

# ç­‰å¾…2ç§’è®©æœåŠ¡å™¨å¯åŠ¨
Start-Sleep -Seconds 2

# å¯åŠ¨ä¸¤ä¸ªå®¢æˆ·ç«¯
Start-Process powershell -ArgumentList "-NoExit", "-Command", "cargo run --bin rustchat-cli"
Start-Process powershell -ArgumentList "-NoExit", "-Command", "cargo run --bin rustchat-cli"
```

**Linux/macOS (Bash)**:
```bash
#!/bin/bash
# å¯åŠ¨æœåŠ¡å™¨
gnome-terminal -- bash -c "cargo run --bin rustchatd; exec bash" &

# ç­‰å¾…æœåŠ¡å™¨å¯åŠ¨
sleep 2

# å¯åŠ¨ä¸¤ä¸ªå®¢æˆ·ç«¯
gnome-terminal -- bash -c "cargo run --bin rustchat-cli; exec bash" &
gnome-terminal -- bash -c "cargo run --bin rustchat-cli; exec bash" &
```

## ğŸ—ï¸ é¡¹ç›®ç»“æ„

```
rustchat/
â”œâ”€â”€ Cargo.toml                    # å·¥ä½œç©ºé—´é…ç½®
â”œâ”€â”€ Cargo.lock                    # ä¾èµ–é”å®šæ–‡ä»¶
â”œâ”€â”€ README.md                     # é¡¹ç›®æ–‡æ¡£
â”œâ”€â”€ todo                         # å¼€å‘ä»»åŠ¡æ¸…å•
â”œâ”€â”€ crates/
â”‚   â”œâ”€â”€ rustchat-types/          # ğŸ“¦ å…±äº«ç±»å‹å®šä¹‰
â”‚   â”‚   â”œâ”€â”€ src/
â”‚   â”‚   â”‚   â”œâ”€â”€ user.rs          # ç”¨æˆ·IDç±»å‹
â”‚   â”‚   â”‚   â”œâ”€â”€ message.rs       # æ¶ˆæ¯ç±»å‹å®šä¹‰
â”‚   â”‚   â”‚   â””â”€â”€ lib.rs
â”‚   â”‚   â””â”€â”€ Cargo.toml
â”‚   â”œâ”€â”€ rustchat-core/           # ğŸ§  æ ¸å¿ƒåŠŸèƒ½åº“  
â”‚   â”‚   â”œâ”€â”€ src/
â”‚   â”‚   â”‚   â”œâ”€â”€ database.rs      # SQLiteæ•°æ®åº“ç®¡ç†
â”‚   â”‚   â”‚   â”œâ”€â”€ user.rs          # ç”¨æˆ·é…ç½®ç®¡ç†
â”‚   â”‚   â”‚   â”œâ”€â”€ bot.rs           # æœºå™¨äººç³»ç»Ÿ
â”‚   â”‚   â”‚   â””â”€â”€ lib.rs
â”‚   â”‚   â””â”€â”€ Cargo.toml
â”‚   â”œâ”€â”€ rustchat-server/         # ï¿½ï¸ WebSocketæœåŠ¡å™¨
â”‚   â”‚   â”œâ”€â”€ src/
â”‚   â”‚   â”‚   â””â”€â”€ main.rs          # æœåŠ¡å™¨ä¸»ç¨‹åº
â”‚   â”‚   â””â”€â”€ Cargo.toml
â”‚   â”œâ”€â”€ rustchat-cli/            # ğŸ’» å‘½ä»¤è¡Œå®¢æˆ·ç«¯
â”‚   â”‚   â”œâ”€â”€ src/
â”‚   â”‚   â”‚   â”œâ”€â”€ main.rs          # CLIä¸»ç¨‹åº 
â”‚   â”‚   â”‚   â””â”€â”€ colors.rs        # é¢œè‰²ä¸»é¢˜ç³»ç»Ÿ
â”‚   â”‚   â””â”€â”€ Cargo.toml
â”‚   â””â”€â”€ rustchat-gui/            # ğŸ–¼ï¸ æ¡Œé¢GUIå®¢æˆ·ç«¯ (Tauri + Svelte)
â”‚       â”œâ”€â”€ src/                 # Svelteå‰ç«¯æºç 
â”‚       â”œâ”€â”€ src-tauri/           # Ruståç«¯æºç   
â”‚       â”œâ”€â”€ package.json         # å‰ç«¯ä¾èµ–é…ç½®
â”‚       â”œâ”€â”€ vite.config.js       # Viteæ„å»ºé…ç½®
â”‚       â””â”€â”€ DEVELOPMENT.md       # GUIå¼€å‘æŒ‡å—
â””â”€â”€ target/                      # ç¼–è¯‘è¾“å‡ºç›®å½•
```

### æ ¸å¿ƒç»„ä»¶è¯¦è§£

#### ğŸ“¦ rustchat-types
**å…±äº«ç±»å‹å®šä¹‰åº“**
- `UserId`: ç±»å‹å®‰å…¨çš„UUIDå°è£…
- `Message`: ç»Ÿä¸€æ¶ˆæ¯æ ¼å¼ï¼ˆæ–‡æœ¬ã€ç³»ç»Ÿã€æ˜µç§°å˜æ›´ï¼‰
- è·¨ç»„ä»¶æ•°æ®äº¤æ¢çš„æ ‡å‡†æ¥å£

#### ğŸ§  rustchat-core  
**ä¸šåŠ¡é€»è¾‘æ ¸å¿ƒåº“**
- `UserConfigManager`: ç”¨æˆ·é…ç½®æŒä¹…åŒ– (`~/.rustchat/config.json`)
- `MessageDatabase`: SQLiteæ¶ˆæ¯å†å²å­˜å‚¨
- `BotManager`: å¯æ‰©å±•çš„æœºå™¨äººç³»ç»Ÿæ¡†æ¶
- æ–‡ä»¶ç³»ç»Ÿæ“ä½œä¸é”™è¯¯å¤„ç†

#### ğŸ–¥ï¸ rustchat-server
**é«˜æ€§èƒ½WebSocketæœåŠ¡å™¨**
- åŸºäº `tokio-tungstenite` çš„å¼‚æ­¥WebSocket
- å®æ—¶æ¶ˆæ¯å¹¿æ’­ (ä¸€å¯¹å¤š)
- ç”¨æˆ·è¿æ¥ç”Ÿå‘½å‘¨æœŸç®¡ç†
- å¿ƒè·³ä¿æ´»ä¸è‡ªåŠ¨æ¸…ç†
- é›†æˆæœºå™¨äººç³»ç»Ÿ

#### ğŸ’» rustchat-cli
**ç°ä»£åŒ–ç»ˆç«¯å®¢æˆ·ç«¯**
- åŸºäº `crossterm` çš„è·¨å¹³å°ç»ˆç«¯UI
- å½©è‰²ä¸»é¢˜ä¸ç¾è§‚æ’ç‰ˆ
- ç»“æ„åŒ–å‘½ä»¤ç³»ç»Ÿ (`/nick`, `/history` ç­‰)
- è‡ªåŠ¨é‡è¿ä¸æ–­çº¿æ¢å¤
- æœ¬åœ°æ¶ˆæ¯å†å²ç¼“å­˜

## ğŸ“„ é…ç½®è¯´æ˜

### ç”¨æˆ·é…ç½®æ–‡ä»¶
**ä½ç½®**: `~/.rustchat/config.json`

```json
{
  "user_id": "550e8400-e29b-41d4-a716-446655440000",
  "nickname": "Alice", 
  "version": "0.1.0"
}
```

### æ¶ˆæ¯æ•°æ®åº“
**ä½ç½®**: `~/.rustchat/messages.db` (SQLite)

```sql
-- æ¶ˆæ¯è¡¨ç»“æ„
CREATE TABLE messages (
    id INTEGER PRIMARY KEY AUTOINCREMENT,
    user_id TEXT NOT NULL,
    from_nick TEXT,
    content TEXT NOT NULL,
    message_type TEXT NOT NULL,
    timestamp DATETIME DEFAULT CURRENT_TIMESTAMP
);
```

## ğŸ”§ å¼€å‘ç‰¹æ€§

### æŠ€æœ¯æ¶æ„
- **å¼‚æ­¥ä¼˜å…ˆ**: åŸºäº `tokio` çš„é«˜æ€§èƒ½å¼‚æ­¥è¿è¡Œæ—¶
- **ç±»å‹å®‰å…¨**: Rustå¼ºç±»å‹ç³»ç»Ÿï¼Œç¼–è¯‘æ—¶é”™è¯¯æ£€æŸ¥  
- **å†…å­˜å®‰å…¨**: é›¶æ‹·è´è®¾è®¡ï¼Œæ— GCçš„é«˜æ€§èƒ½å†…å­˜ç®¡ç†
- **è·¨å¹³å°**: æ”¯æŒ Windowsã€Linuxã€macOS

### ä¾èµ–æŠ€æœ¯æ ˆ
- **ç½‘ç»œ**: `tokio-tungstenite` (WebSocket)
- **æ•°æ®åº“**: `sqlx` (SQLiteå¼‚æ­¥é©±åŠ¨)
- **åºåˆ—åŒ–**: `serde` + `serde_json`
- **ç»ˆç«¯UI**: `crossterm` (è·¨å¹³å°ç»ˆç«¯æ§åˆ¶)
- **æ—¥å¿—**: `tracing` (ç»“æ„åŒ–æ—¥å¿—)
- **UUID**: `uuid` (RFC 4122æ ‡å‡†)

## ğŸ” æ—¥å¿—å’Œè°ƒè¯•

é¡¹ç›®ä½¿ç”¨ `tracing` è¿›è¡Œç»“æ„åŒ–æ—¥å¿—è®°å½•ï¼š

```bash
# æ˜¾ç¤ºè¯¦ç»†æ—¥å¿—
RUST_LOG=debug cargo run --bin rustchatd

# æ˜¾ç¤ºç‰¹å®šæ¨¡å—æ—¥å¿—  
RUST_LOG=rustchat_server=info,rustchat_core=debug cargo run --bin rustchatd

# å®¢æˆ·ç«¯è°ƒè¯•
RUST_LOG=rustchat_cli=debug cargo run --bin rustchat-cli
```

## ğŸ§ª æµ‹è¯•

```bash
# è¿è¡Œæ‰€æœ‰æµ‹è¯•
cargo test

# è¿è¡Œç‰¹å®šåŒ…çš„æµ‹è¯•
cargo test -p rustchat-types
cargo test -p rustchat-core

# è¿è¡Œé›†æˆæµ‹è¯•
cargo test --test integration_tests
```

## ğŸš€ æ€§èƒ½ç‰¹æ€§

- **å¹¶å‘**: æ”¯æŒæ•°åƒä¸ªå¹¶å‘WebSocketè¿æ¥
- **å†…å­˜**: ä½å†…å­˜å ç”¨ï¼Œæ¶ˆæ¯é›¶æ‹·è´ä¼ è¾“
- **å»¶è¿Ÿ**: äºšæ¯«ç§’çº§æ¶ˆæ¯è½¬å‘å»¶è¿Ÿ
- **åå**: å•æ ¸å¤„ç†æ•°ä¸‡æ¡æ¶ˆæ¯/ç§’

## ğŸ› ï¸ æ•…éšœæ’é™¤

### å¸¸è§é—®é¢˜

**Q: æœåŠ¡å™¨å¯åŠ¨å¤±è´¥ï¼Œæç¤ºç«¯å£è¢«å ç”¨**
```bash
# æ£€æŸ¥ç«¯å£å ç”¨
netstat -ano | findstr :8080  # Windows
lsof -i :8080                 # Linux/macOS

# ä½¿ç”¨å…¶ä»–ç«¯å£ï¼ˆä¿®æ”¹ä»£ç ä¸­çš„ç«¯å£é…ç½®ï¼‰
```

**Q: å®¢æˆ·ç«¯æ— æ³•è¿æ¥åˆ°æœåŠ¡å™¨**
```bash
# ç¡®è®¤æœåŠ¡å™¨å·²å¯åŠ¨
curl http://127.0.0.1:8080/health

# æ£€æŸ¥é˜²ç«å¢™è®¾ç½®
# ç¡®è®¤WebSocketåœ°å€æ­£ç¡®: ws://127.0.0.1:8080/ws
```

**Q: æ¶ˆæ¯å†å²ä¸æ˜¾ç¤º**
```bash
# æ£€æŸ¥æ•°æ®åº“æ–‡ä»¶æƒé™
ls -la ~/.rustchat/messages.db

# é‡æ–°åˆå§‹åŒ–æ•°æ®åº“ï¼ˆä¼šæ¸…ç©ºå†å²ï¼‰
rm ~/.rustchat/messages.db
```

### è°ƒè¯•æŠ€å·§

1. **å¯ç”¨è¯¦ç»†æ—¥å¿—**: `RUST_LOG=debug`
2. **æ£€æŸ¥é…ç½®æ–‡ä»¶**: `cat ~/.rustchat/config.json`
3. **éªŒè¯æ•°æ®åº“**: ä½¿ç”¨SQLiteå·¥å…·æŸ¥çœ‹ `~/.rustchat/messages.db`
4. **ç½‘ç»œæµ‹è¯•**: ä½¿ç”¨ `wscat` å·¥å…·æµ‹è¯•WebSocketè¿æ¥

## ğŸ“Š å¼€å‘ç»Ÿè®¡

- **ä»£ç è¡Œæ•°**: ~2000+ è¡Œ Rustä»£ç 
- **ä¾èµ–åŒ…**: 20+ ç²¾é€‰ä¾èµ–
- **åŠŸèƒ½æ¨¡å—**: 4ä¸ªç‹¬ç«‹crate
- **æµ‹è¯•è¦†ç›–**: æ ¸å¿ƒé€»è¾‘å•å…ƒæµ‹è¯•
- **æ–‡æ¡£**: å®Œæ•´çš„APIæ–‡æ¡£å’Œä½¿ç”¨æŒ‡å—

---

## ğŸ¯ è·¯çº¿å›¾

### M1 - é«˜çº§åŠŸèƒ½ (è®¡åˆ’ä¸­)
- [ ] å¤šæˆ¿é—´/é¢‘é“æ”¯æŒ
- [ ] æ–‡ä»¶ä¼ è¾“åŠŸèƒ½  
- [ ] æ¶ˆæ¯åŠ å¯†
- [ ] Webå®¢æˆ·ç«¯ç•Œé¢
- [ ] è‡ªå®šä¹‰æœºå™¨äººæ’ä»¶

### M2 - ç”Ÿäº§å°±ç»ª (è®¡åˆ’ä¸­)  
- [ ] Dockerå®¹å™¨åŒ–éƒ¨ç½²
- [ ] è´Ÿè½½å‡è¡¡ä¸é›†ç¾¤
- [ ] ç”¨æˆ·è®¤è¯ä¸æƒé™
- [ ] æ¶ˆæ¯æŒä¹…åŒ–ä¸å¤‡ä»½
- [ ] ç›‘æ§ä¸å‘Šè­¦ç³»ç»Ÿ

### M3 - ä¼ä¸šåŠŸèƒ½ (è®¡åˆ’ä¸­)
- [ ] LDAP/SSOé›†æˆ
- [ ] å®¡è®¡æ—¥å¿—
- [ ] API Gateway
- [ ] å¤šè¯­è¨€æ”¯æŒ
- [ ] ç§»åŠ¨ç«¯åº”ç”¨

---

**ğŸ† æ„Ÿè°¢ä½¿ç”¨ RustChatï¼æ¬¢è¿æäº¤ Issue å’Œ PRï¼**